---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
---

<Layout title="External Image Optimization">
	<main>
		<h1>üåê External Image Optimization</h1>
		<p>This page demonstrates how to optimize external images in Astro using various techniques.</p>
		
		<div class="external-image-demo">
			<h2>üì∏ External Image Examples</h2>
			
			<div class="image-example">
				<h3>Method 1: Regular img tag with optimization attributes</h3>
				<img 
					src="https://picsum.photos/400/300?random=1"
					alt="External image example 1"
					width="400"
					height="300"
					loading="lazy"
					decoding="async"
					class="external-image"
				/>
				<p class="image-note">Uses loading="lazy" and decoding="async" for performance</p>
			</div>
			
			<div class="image-example">
				<h3>Method 2: Responsive image with srcset</h3>
				<img 
					src="https://picsum.photos/400/300?random=2"
					srcset="
						https://picsum.photos/200/150?random=2 200w,
						https://picsum.photos/400/300?random=2 400w,
						https://picsum.photos/800/600?random=2 800w
					"
					sizes="(max-width: 600px) 200px, (max-width: 1200px) 400px, 800px"
					alt="Responsive external image"
					width="400"
					height="300"
					loading="lazy"
					class="external-image"
				/>
				<p class="image-note">Uses srcset for responsive images</p>
			</div>
			
			<div class="image-example">
				<h3>Method 3: Picture element with multiple formats</h3>
				<picture>
					<source 
						srcset="https://picsum.photos/400/300.webp?random=3" 
						type="image/webp"
					/>
					<img 
						src="https://picsum.photos/400/300?random=3"
						alt="Picture element example"
						width="400"
						height="300"
						loading="lazy"
						class="external-image"
					/>
				</picture>
				<p class="image-note">Uses picture element for format fallbacks</p>
			</div>
		</div>
		
		<div class="optimization-techniques">
			<h2>üõ†Ô∏è External Image Optimization Techniques</h2>
			<div class="techniques-grid">
				<div class="technique-card">
					<h3>üöÄ Lazy Loading</h3>
					<p>Use <code>loading="lazy"</code> to defer loading images until they're needed</p>
					<pre><code>&lt;img loading="lazy" ... /&gt;</code></pre>
				</div>
				
				<div class="technique-card">
					<h3>‚ö° Async Decoding</h3>
					<p>Use <code>decoding="async"</code> to prevent blocking the main thread</p>
					<pre><code>&lt;img decoding="async" ... /&gt;</code></pre>
				</div>
				
				<div class="technique-card">
					<h3>üì± Responsive Images</h3>
					<p>Use <code>srcset</code> and <code>sizes</code> for different screen sizes</p>
					<pre><code>&lt;img srcset="small.jpg 300w, large.jpg 800w" /&gt;</code></pre>
				</div>
				
				<div class="technique-card">
					<h3>üñºÔ∏è Modern Formats</h3>
					<p>Use <code>&lt;picture&gt;</code> element for WebP/AVIF with fallbacks</p>
					<pre><code>&lt;picture&gt;
  &lt;source srcset="image.webp" type="image/webp"&gt;
  &lt;img src="image.jpg" alt="..."&gt;
&lt;/picture&gt;</code></pre>
				</div>
			</div>
		</div>
		
		<div class="cdn-services">
			<h2>‚òÅÔ∏è Image CDN Services</h2>
			<p>For better external image optimization, consider using image CDN services:</p>
			<div class="cdn-grid">
				<div class="cdn-card">
					<h3>Cloudinary</h3>
					<p>Automatic optimization, format conversion, and resizing</p>
					<code>https://res.cloudinary.com/demo/image/fetch/w_400,f_auto,q_auto/https://example.com/image.jpg</code>
				</div>
				
				<div class="cdn-card">
					<h3>ImageKit</h3>
					<p>Real-time image optimization and transformation</p>
					<code>https://ik.imagekit.io/demo/tr:w-400,f-auto,q-auto/https://example.com/image.jpg</code>
				</div>
				
				<div class="cdn-card">
					<h3>Cloudflare Images</h3>
					<p>Global CDN with automatic optimization</p>
					<code>https://imagedelivery.net/account/image-id/w=400,f=auto,q=auto</code>
				</div>
			</div>
		</div>
		
		<div class="performance-tips">
			<h2>‚ö° Performance Tips</h2>
			<ul>
				<li><strong>Preload critical images:</strong> Use <code>&lt;link rel="preload" as="image"&gt;</code> for above-the-fold images</li>
				<li><strong>Set dimensions:</strong> Always specify width and height to prevent layout shift</li>
				<li><strong>Use appropriate formats:</strong> WebP for photos, SVG for icons and simple graphics</li>
				<li><strong>Optimize quality:</strong> Use 80-85% quality for most images</li>
				<li><strong>Consider aspect ratios:</strong> Use CSS aspect-ratio to maintain layout</li>
				<li><strong>Implement blur placeholders:</strong> Show low-quality placeholders while loading</li>
			</ul>
		</div>
		
		<div class="info-box">
			<h2>‚ÑπÔ∏è External vs Internal Images</h2>
			<div class="comparison-table">
				<table>
					<thead>
						<tr>
							<th>Aspect</th>
							<th>Internal Images</th>
							<th>External Images</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Optimization</td>
							<td>Automatic by Astro</td>
							<td>Manual or CDN-based</td>
						</tr>
						<tr>
							<td>Build Time</td>
							<td>Processed during build</td>
							<td>No build processing</td>
						</tr>
						<tr>
							<td>Caching</td>
							<td>Cached with site</td>
							<td>Depends on external server</td>
						</tr>
						<tr>
							<td>Control</td>
							<td>Full control</td>
							<td>Limited control</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		
		<a href="/" class="back-link">‚Üê Back to Home</a>
	</main>
</Layout>

<style>
		main {
		margin: auto;
		padding: 1rem;
		width: 800px;
		max-width: calc(100% - 2rem);
		color: rgb(13, 2, 79);
		font-size: 20px;
		line-height: 1.6;
	}
	
	nav ul {
		list-style: none;
		padding: 0;
	}
	
	nav li {
		margin: 0.5rem 0;
	}
	
	nav a {
		color: #311d42;
		text-decoration: underline;
		padding: 0.5rem;
		border-radius: 4px;
		transition: background-color 0.3s;
	}
	
	nav a:hover {
		background-color: rgba(79, 57, 250, 0.1);
	}
	
	h1 {
		font-size: 4rem;
		font-weight: 700;
		line-height: 1;
		text-align: center;
		margin-bottom: 1em;
	}
	
	h2 {
		color: #000000;
	}

	#codeBlock {
		display: inline-block;
		border-radius: 1px;
		border: 1px solid transparent;
		padding: 6px 8px;
		background-color:#dadada;
		width: 100%;
	}

	#click-counter {
		padding: 8px 16px;
		background-color: #61dafb;
		border: none;
		border-radius: 4px;
		cursor: pointer;
	}

	#current-time {
		display: inline;
	}
</style>
